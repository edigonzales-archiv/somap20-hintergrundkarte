<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="HandheldFriendly" content="true" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ol3/4.0.1/ol.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.10/proj4.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ol3/4.0.1/ol.js"></script>
  <title>Hintergrundkarte WMS</title>
</head>
<body>
  <div id="map" style="width: 500px"></div>
  <script type="text/javascript">

  var resolutionModes = ['foo', 'bar']
  var mode = getParameterByName('mode');

  if (resolutionModes.indexOf(mode) < 0) {
    mode = 'foo'
  }

  var startZoom = null;
  var mapResolutions = null;

  if (mode == 'foo') {
    startZoom = 6;
    mapResolutions = [4000,2000,1000,500,250,100,50,20,10,5,2.5,1.0,0.5,0.25,0.1,0.05];
  } else {
    startZoom = 18;
    mapResolutions = [4000,3750,3500,3250,3000,2750,2500,2250,2000,1750,1500,1250,1000,750,650,500,250,100,50,20,10,5,2.5,2,1.5,1,0.5,0.25,0.1,0.05];
  }

  var imageFormat = "image/jpeg";

  var projection = new ol.proj.Projection({
    code: 'EPSG:2056',
    extent: [2420000, 1030000, 2900000, 1350000],
    units: 'm'
  });

  var projectionExtent = projection.getExtent();

  var zoomLevels = 29;
  var resolutions = [4000,3750,3500,3250,3000,2750,2500,2250,2000,1750,1500,1250,1000,750,650,500,250,100,50,20,10,5,2.5,2,1.5,1,0.5,0.25,0.1];
  var matrixIds = new Array(resolutions.length);
  var matrixSet = '21781';

  for (var z = 0; z < zoomLevels; ++z) {
    matrixIds[z] = z;
  }

  var layers = [
    new ol.layer.Image({
      extent: [2420000, 1030000, 2900000, 1350000],
      source: new ol.source.ImageWMS({
        url: 'http://35.158.123.43/cgi-bin/qgis_mapserv.fcgi?map=/tmp/somap20-hintergrundkarte/qgis/hintergrundkarte.qgs',
        params: {'LAYERS': 'ch.so.agi.hintergrundkarte-grau'},
        ratio: 1
      })
    })
  ];

  var map = new ol.Map({
    controls: ol.control.defaults().extend([
      new ol.control.FullScreen()
    ]),
    ol3Logo: false,
    target: document.getElementById('map'),
    layers: layers,
    view: new ol.View({
      projection: projection,
      center: [2618000, 1236700],
      zoom: startZoom,
      resolutions: mapResolutions

    })
  });

  function getParameterByName(name) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
  }
  </script>
</body>
</html>
